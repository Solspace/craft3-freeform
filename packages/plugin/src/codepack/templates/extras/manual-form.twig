{% extends "freeform-demo/_layout" %}

{% set pageTitle = "Extras" %} 
{% set page = "extras" %} 

{# Replace 'basicManual' with your form handle. #}
{% set form = craft.freeform.form("basicManual") %}

{% block content %}

<div class="container">

	<h2>Manual Rendering of Forms</h2>
	<p>The example formatting form completely manually</p>

	{% if form %}

		<h3> {{ form.name }}</h3> 
		<br />

		{# Replace "freeform-demo/extra/manual-form" where to return after the form will be submitted #}
		{{ form.renderTag({returnUrl: "freeform-demo/extra/manual-form"}) }}

			{% if form.hasErrors %}
				<div class="freeform-form-has-errors">
					{{ "There was an error submitting this form"|t }}

					{% if form.errors|length %}
						<ul>
							{% for error in form.errors %}
								<li>{{ error }}</li>
							{% endfor %}
						</ul>
					{% endif %}
				</div>
			{% endif %}

			{# Set up your needed form page fields #}
			{% set firstName = form.get("firstName") %}
			{% set company = form.get("company") %}
			{% set lastName = form.get("lastName") %}
			{% set recipients = form.get("recipients") %}

			<label>{{ firstName.label }}</label>
			<input name="{{ firstName.handle }}" value="{{ firstName.value }}" />
			{{ firstName.renderErrors() }}

			<label>{{ lastName.label }}</label>
			<input name="{{ lastName.handle }}" value="{{ lastName.value }}" />
			{{ lastName.renderErrors() }}
			{{ company.renderLabel() }}
			{{ company.renderInput() }}
			{{ company.renderErrors() }}

			<label>Email Address</label>
			<input name="email" />
			{{ form.get("email").renderErrors() }}

			<label>Phone</label>
			<input name="phone" />
			{% if form.get("phone").hasErrors %}
				This field is required!
			{% endif %}

			<label>Recipient</label>
			<select name="{{ recipients.handle }}" type="dynamic_recipients">
				{% for recipients in recipients.options %}
					<option value="{{ loop.index0 }}">{{ recipients.label }}</option>

				{% endfor %}

			</select>

			<button type="submit">Submit</button>
			
			{# Replace "12" with the form Id you need from CP #}
			{# Write first name and last name in the "fieldSearch" sections. #}
			{% set submissions = craft.freeform.submissions({
				formId: 12,
				orderBy: "firstName DESC",
				fieldSearch: {
					firstName: "",
					lastName: "",
				}
			}) %}

			<h2>Submissions</h2>

			{% for submission in submissions %}
				<div>
					<div>
						{{ submission.title }} - 
						{{ submission.firstName }}
						{{ submission.lastName }}
					</div>
				</div>
			{% endfor %}

		{{ form.renderClosingTag }}

	{% else %}
	{# Show instructions to developer if they wish to see this page work correctly #}

		<div class="alert alert-warning" role="alert">
            <h4 class="alert-heading">You can't see this page correctly until...</h4>
            <p class="mb-0">
                In order to view this page live, you'll need to make some adjustments to this template or on your test from:
                <ol class="mb-0">
                    <li>Rename your test form handle to <code>basicManual</code> ( or adjust the handle name this template is looking for).</li>
                    <li>
                        Make sure your t est form includes the following fields (at minimum):
                        <ul>
                            <li>First Name text field with handle of <code>firstName</code>.</li> 
                            <li>Last Name text field with handle of <code>LastName</code>.</li>
                            <li>Company Name text field with handle of <code>companyName</code>.</li>
                            <li>recipient text field with handle of <code>recipients</code>.</li>
                            <li>Email address field with handle of  <code>email</code>.</li>
                            <li>Phone text field with handle of <code>phone</code>.</li>
                        </ul>
                    </li>
                    <li>The person viewing this form is logged into their Craft account to see this working.</li>
                    <li>The person viewing this form have a first and last name set in their User account.</li>
                </ol>
            </p>
        </div>

	{% endif %}

</div>

{% endblock %}